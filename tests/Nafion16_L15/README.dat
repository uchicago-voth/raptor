1. Convert starting CHARMM structure to LAMMPS format
   --------------------------------------------------------------------------------
   cd chm2lmp

   perl charmm2lammps.pl nafion Nafion16_L15 65.205 65.205 65.205 > chm2lmp.log

   cd ..
   --------------------------------------------------------------------------------
   Inputs:  charmm2lammps.pl
            top_nafion.rtf
            par_nafion.par
            Nafion16_L15.psf
            Nafion16_L15.crd (Nafion16_L15.pdb will be used if without Nafion16_L15.crd)

   Outputs: Nafion16_L15_ctrl.psf
            Nafion16_L15_ctrl.pdb
            Nafion16_L15.data
            Nafion16_L15.in

2. Update LAMMPS *.data for equilibration
   --------------------------------------------------------------------------------
   cp chm2lmp/Nafion16_L15.data equi/nafion.data

   1) Update x/y/zlo x/y/zhi
   2) Delete Pair/Bond/Angle/Dihedral Coeffs sections
   --------------------------------------------------------------------------------

3. Equilibrate
   --------------------------------------------------------------------------------
   cp nafion.data equil/
   cd equi

   lammps -in lmp_1.inp > lmp_1.out
   lammps -in lmp_2.inp > lmp_2.out
   lammps -in lmp_3.inp > lmp_3.out
   lammps -in lmp_4.inp > lmp_4.out

   cd ..
   --------------------------------------------------------------------------------

4. Update LAMMPS *.data for MS-RMD
   --------------------------------------------------------------------------------
   cp equi/nafion.data .

   Update following sections in nafion.data using those from equi/nafion-NVT300.data
     1) x/y/zlo x/y/zhi
     2) "Atoms # full"
   --------------------------------------------------------------------------------

5. Update bond_coeff.inp for MS-RMD
   --------------------------------------------------------------------------------
   To make O-H bond reactive, replace the harmonic potential with Morse potential.
   --------------------------------------------------------------------------------

6. Prepare nafion.top
   --------------------------------------------------------------------------------
   1st column: atom number


   2nd column: index of a reactive molecule/residue defined in in.evb

               1 --> hydronium,	H3O
               2 --> water,	H2O


   3rd column: index of atoms in a reactive molecule/residue defined in evb_single.par


   E.g., for the last hydronium here,
         1) in nafion.data, the "Atoms" section
               17981    3616    11     -0.32          -23.871          -16.315            8.283  # OTH
               17982    3616    10      0.44          -23.214          -16.947            8.634  # HTH
               17983    3616    10      0.44          -23.635          -16.090            7.352  # HTH
               17984    3616    10      0.44          -23.724          -15.457            8.772  # HTH

         2) in in.evb
            settype H3O 1 : hydronium

         3) in evb_single.par
            [molecule_type.start.H3O]

            :      HO        2
            :      |         |
            :      OH        1
            :     / \       / \
            :   HO   HO    3   4

            : number of atoms,   bonds,   angles,  dihedrals,   impropers,   starting rc
                          4        3        3         0           0          1
            : atomic information
            : atom type   charge   kernel
              OH          -0.32     1
              HO           0.44     1
              HO           0.44     1
              HO           0.44     1

         4) in nafion.top
            17981 1 1
            17982 1 2
            17983 1 3
            17984 1 4
   --------------------------------------------------------------------------------

7. Prepare "Declare LAMMPS Types" secion in in.evb
   --------------------------------------------------------------------------------
   Atom/Bond/Angle/Dihedral/Improper   "names"     should match those defined in evb_single.par
   Atom/Bond/Angle/Dihedral/Improper   "indeces"   should match those defined in nafion.data & bond_coeff.inp & pair_coeff.inp

   E.g., for hydronium here,
         1) in in.evb
            : Atom Type
            #define OH 11
            #define HO 10

            : Bond Type
            #define OH-HO 10

            : Angle Type
            #define HO-OH-HO 22

         2) in evb_single.par
            [molecule_type.start.H3O]

            :      HO        2
            :      |         |
            :      OH        1
            :     / \       / \
            :   HO   HO    3   4

            : number of atoms,   bonds,   angles,  dihedrals,   impropers,   starting rc
                          4        3        3         0           0          1
            : atomic information
            : atom type   charge   kernel
              OH          -0.32     1
              HO           0.44     1
              HO           0.44     1
              HO           0.44     1
            : bonds
            :  atom 1       atom 2      type
               1            2           OH-HO
               1            3           OH-HO
               1            4           OH-HO
            : angles
            :  atom 1       atom 2       atom 3     type
               2            1            3          HO-OH-HO
               2            1            4          HO-OH-HO
               3            1            4          HO-OH-HO

            : COC
            4
            1 2 3 4

            [molecule_type.end]

         3) in nafion.data
            Masses
                  10      1.008  # HTH
                  11    15.9994  # OTH

         4) in bond_coeff.inp
            bond_coeff      10      morse            79.086356     2.083387      0.98  # HTH  OTH
            angle_coeff     22      38.7434     111.727   # HTH  OTH  HTH

         5) in pair_coeff.inp
            pair_coeff  10  10  0.000040583  0              # HTH
            pair_coeff  11  11  0.098609686  3.11850721837  # OTH
   --------------------------------------------------------------------------------

8. Run MS-RMD simulations
   --------------------------------------------------------------------------------
   sbatch msrmd.qsub

   Update "set stage = 1    # current stage" line to continue the simulation
   --------------------------------------------------------------------------------
